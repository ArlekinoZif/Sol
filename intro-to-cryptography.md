---
назва: Криптографія та мережа Solana
завдання:
- Зрозуміти симетричну та асиметричну криптографію
- Пояснити пари ключів
- Створити нову пару ключів
- Завантажити пару ключів з env файлу
---

# Стислий виклад

- **Пара ключів** — це відповідна пара **публічного ключа** та **секретного ключа**.  
- **Публічний ключ** використовується як «адреса», що вказує на акаунт у мережі Solana. Публічним ключем можна ділитися з будь-ким.  
- **Секретний ключ** використовується для підтвердження права власності над акаунтом. Як випливає з назви, секретні ключі слід завжди тримати *в секреті*.  
- `@solana/web3.js` надає допоміжні функції для створення нової пари ключів або для створення пари ключів з використанням наявного секретного ключа.

# Урок

## Симетрична та асиметрична криптографія  

'Криптографія' це буквально наука про приховування інформації. Існує два основних види криптографії, з якими ви будети стикатися щодня:  

**Симетрична криптографія** — це метод, у якому для шифрування та розшифрування використовується один і той самий ключ. Вона існує вже сотні років і застосовувалася ще від часів стародавніх єгиптян до королеви Єлизавети I.  

Існує багато алгоритмів симетричної криптографії, але найпоширенішими сьогодні є AES і Chacha20.

**Асиметрична криптографія**  

- Асиметрична криптографія, також відома як ['криптографія з відкритим ключем'](https://en.wikipedia.org/wiki/Public-key_cryptography), була розроблена у 1970-х роках. В асиметричній криптографії учасники використовують пари ключів (**keypairs**). Кожна пара ключів складається з **секретного ключа** та **публічного ключа**. Асиметричне шифрування працює інакше, ніж симетричне, і може виконувати різні завдання:

- **Шифрування**: якщо дані зашифровані за допомогою публічного ключа, їх можна розшифрувати лише секретним ключем з тієї ж пари ключів.  
- **Підписи**: якщо дані зашифровані секретним ключем, публічний ключ з тієї ж пари ключів може бути використаний для підтвердження того, що власник секретного ключа підписав їх.
- Асиметричну криптографію можна навіть використовувати для узгодження надійного ключа для симетричної криптографії! Це називається **обмін ключами**, коли ваші публічні ключі та публічний ключ отримувача використовуються для створення ключа сесії.  
- Існує багато алгоритмів асиметричної криптографії, але найпоширенішими сьогодні є варіанти ECC або RSA.

Асиметричне шифрування є дуже популярним:  

- Ваша банківська картка містить секретний ключ, який використовується для підпису транзакцій.
 
  Ваш банк може підтвердити, що саме ви здійснили транзакцію, перевіривши підпис за допомогою відповідного публічного ключа.  
- Вебсайти включають публічний ключ у свій сертифікат. Ваш браузер використовує цей публічний ключ для шифрування даних (таких як особиста інформація, облікові дані та номери банківських карток), які він надсилає на веб-сторінку.
  
  Вебсайт має відповідний приватний ключ, щоб розшифрувати отримані дані.  
- Ваш електронний паспорт підписаний країною, яка його видала, щоб гарантувати його справжність.
  
  Електронні паспортні контролі можуть підтвердити це, використовуючи публічний ключ країни-емітента.  
- Месенджери на вашому телефоні використовують обмін ключами для створення ключа сесії.
  
Коротко кажучи, криптографія оточує нас всюди. Solana, як і інші блокчейни, є лише одним із застосувань криптографії.

## Solana використовує публічні ключі як адреси

![Solana wallet addresses](../assets/wallet-addresses.svg)

Учасники мережі Solana мають принаймні одну пару ключів. У Solana:

- **Публічний ключ** використовується як «адреса», що вказує на акаунт у мережі Solana. Навіть зручні імена (домени), такі як `example.sol`, прив’язані до адрес, наприклад, `dDCQNnDmNbFVi8cQhKAgXhyhXeJ625tvwsunRyRc7c8`.
 
- **Секретний ключ** використовується для підтвердження права власності. Якщо у вас є секретний ключ від певної адреси, ви контролюєте токени, що знаходяться на цій адресі. З цієї причини, як випливає з назви, секретні ключі слід завжди тримати *в секреті*.  
## Використання `@solana/web3.js` для створення пари ключів

Ви можете використовувати блокчейн Solana як у браузері, так і в Node.js за допомогою npm-модуля `@solana/web3.js`. Налаштуйте проект звичним для вас способом, а потім [використайте `npm`](https://nodesource.com/blog/an-absolute-beginners-guide-to-using-npm/) для встановлення `@solana/web3.js`.

```
npm i @solana/web3.js
```

Ми поступово розглянемо багато аспектів [web3.js](https://docs.solana.com/developing/clients/javascript-reference) у цьому курсі, але ви також можете ознайомитися з [офіційною документацією web3.js](https://docs.solana.com/developing/clients/javascript-reference).

Щоб надсилати токени, відправляти NFT або читати й записувати дані в Solana, вам знадобиться власна пара ключів. Для її створення використовуйте функцію `Keypair.generate()` з `@solana/web3.js`:

```typescript
import { Keypair } from "@solana/web3.js";

const keypair = Keypair.generate();

console.log(`The public key is: `, keypair.publicKey.toBase58());
console.log(`The secret key is: `, keypair.secretKey);
```

## ⚠️ Не включайте секретні ключі у ваш вихідний код

Оскільки пару ключів можна відновити з секретного ключа, зазвичай ми зберігаємо лише секретний ключ і відновлюємо її з секретного ключа.

Крім того, оскільки секретний ключ надає право власності над адресою, ми не зберігаємо секретні ключі у вихідному коді. Замість цього ми:

- Поміщаємо секретні ключі в файл `.env`.  
- Додаємо `.env` до `.gitignore`, щоб файл `.env` не потрапляв у репозиторій.

## Завантаження існуючої пари ключів

Якщо у вас вже є пара ключів, яку ви хочете використати, ви можете завантажити її з наявного секретного ключа, збереженого у файловій системі або файлі `.env`. У Node.js пакет `@solana-developers/helpers` включає додаткові функції:

```bash
npm i @solana-developers/helpers
```

- Для використання файлу `.env` використовуйте `getKeypairFromEnvironment()`.  
- Для використання файлу Solana CLI використовуйте `getKeypairFromFile()`.

```typescript
import "dotenv/config";
import { getKeypairFromEnvironment } from "@solana-developers/helpers";


const keypair = getKeypairFromEnvironment("SECRET_KEY");
```

Тепер ви знаєте, як створювати та завантажувати пари ключів! Давайте попрактикуємося з тим, що ми вивчили.

# Лабораторна робота 

### Встановлення

Створіть нову директорію, встановіть TypeScript, Solana web3.js та esrun:

```bash
mkdir generate-keypair
cd generate-keypair
npm init -y
npm install typescript @solana/web3.js esrun @solana-developers/helpers
```

Створіть новий файл під назвою `generate-keypair.ts`.

```typescript
import { Keypair } from "@solana/web3.js";
const keypair = Keypair.generate();
console.log(`✅ Generated keypair!`)
```

Запустіть команду `npx esrun generate-keypair.ts`. Ви повинні побачити текст:

```
✅ Generated keypair!
```

Кожна `Keypair` має властивості `publicKey` та `secretKey`.

```typescript
import { Keypair } from "@solana/web3.js";

const keypair = Keypair.generate();

console.log(`The public key is: `, keypair.publicKey.toBase58());
console.log(`The secret key is: `, keypair.secretKey);
console.log(`✅ Finished!`);
```

Запустіть `npx esrun generate-keypair.ts`. Ви повинні побачити текст:

```
The public key is:  764CksEAZvm7C1mg2uFmpeFvifxwgjqxj2bH6Ps7La4F
The secret key is:  Uint8Array(64) [
  (a long series of numbers) 
]
✅ Finished!
```

## Завантаження існуючої пари ключів з файлу .env

Для того, щоб ваш секретний ключ залишався в безпеці, ми рекомендуємо впроваджувати секретний ключ за допомогою файлу `.env`:

Створіть новий файл з назвою `.env` і додайте в нього вміст ключа, який ви створили раніше:

```env
SECRET_KEY="[(a series of numbers)]"
```

Ми можемо завантажити пару ключів з середовища. Оновіть файл `generate-keypair.ts`:

```typescript
import "dotenv/config"
import { getKeypairFromEnvironment } from "@solana-developers/helpers";

const keypair = getKeypairFromEnvironment("SECRET_KEY");

console.log(
  `✅ Finished! We've loaded our secret key securely, using an env file!`
);
```

Запустіть команду `npx esrun generate-keypair.ts`. Ви повинні побачити наступний результат:

```text
✅ Finished! We've loaded our secret key securely, using an env file!
```

Тепер ми дізналися про пари ключів і як зберігати секретні ключі безпечно на Solana. В наступному розділі ми почнемо їх використовувати!


## Завершили Лабораторну роботу?

Завантажте свій код на GitHub і [поділіться своїми враженнями від цього уроку](https://form.typeform.com/to/IPH0UGz7#answers-lesson=ee06a213-5d74-4954-846e-cba883bc6db1)!
